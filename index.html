<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8 å€‹é«˜æ•ˆèƒ½å·¥å…·å·¥ä½œè¡¨ (Tab ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>
    
    <style>
        /* --- å…¨å±€è¨­å®š --- */
        * { box-sizing: border-box; }
        body { font-family: 'Inter', system-ui, sans-serif; }
        
        /* --- Textarea æ¨£å¼ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        .worksheet-input { 
            margin-top: 0.375rem; 
            padding: 0.875rem; 
            display: block; 
            width: 100%; 
            border-radius: 0.5rem; 
            border: 1.5px solid #cbd5e1; 
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); 
            font-size: 0.95rem; 
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); 
            background: linear-gradient(to bottom, #f8fafc, #ffffff);
            min-height: 120px;
            resize: vertical; 
            line-height: 1.6;
        }
        .worksheet-input:hover { 
            border-color: #94a3b8; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }
        .worksheet-input:focus { 
            border-color: #3498db;
            outline: none; 
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.15), 0 2px 8px rgba(52, 152, 219, 0.1);
            background: #ffffff;
        }

        /* --- Tab æ¨£å¼ (ä¾†è‡ªæ‚¨çš„ç¬¬ä¸€å€‹ç¯„æœ¬) --- */
        .tab-buttons { 
            display: flex; 
            border-bottom: 2px solid #e2e8f0; 
            margin-bottom: 1.5rem; 
            overflow-x: auto; 
            white-space: nowrap; 
            gap: 0.25rem;
            -webkit-overflow-scrolling: touch;
        }
        .tab-buttons::-webkit-scrollbar { height: 6px; }
        .tab-buttons::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
        .tab-buttons::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        .tab-btn { 
            flex-shrink: 0; 
            padding: 0.875rem 1.25rem; 
            border-bottom: 3px solid transparent; 
            font-weight: 500; 
            font-size: 0.95rem; 
            cursor: pointer; 
            transition: all 0.2s ease; 
            border-radius: 0.5rem 0.5rem 0 0; 
        }
        .tab-btn.active { 
            border-color: #3498db;
            color: #2980b9;
            font-weight: 600; 
            background: linear-gradient(to bottom, #eaf5fb, #ffffff);
            box-shadow: 0 -2px 8px rgba(52, 152, 219, 0.1);
        }
        .tab-btn.inactive { 
            border-color: transparent; 
            color: #64748b; 
        }
        .tab-btn.inactive:hover { 
            color: #334155; 
            background-color: #f8fafc;
            border-color: #cbd5e1;
        }
        .tab-content { 
            display: none; 
            animation: fadeIn 0.3s ease-out; 
        }
        .tab-content.active { 
            display: block; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(8px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        /* --- éšæ®µé‡é»å¡ç‰‡ (ä¾†è‡ªæ‚¨çš„ç¬¬ä¸€å€‹ç¯„Tç¯„æœ¬ï¼Œç”¨æ–¼èªªæ˜) --- */
        .stage-focus { 
            background: linear-gradient(135deg, #eaf5fb 0%, #f4f9fc 100%);
            border: 2px solid #a9d6f5;
            border-radius: 0.75rem; 
            padding: 1.25rem 1.5rem; 
            margin-bottom: 2rem; 
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.1);
        }
        .stage-focus h3 { 
            font-size: 1.125rem; 
            font-weight: 600; 
            color: #2980b9;
            margin-bottom: 0.75rem; 
        }
        .stage-focus p, .stage-focus li {
            color: #2c5282; /* èª¿æ•´ç‚ºè¼ƒæ·±çš„è—è‰² */
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .stage-focus ul { 
            list-style: none; 
            margin-left: 0;
        }
        .stage-focus li {
            padding-left: 1.5rem;
            position: relative;
            margin-bottom: 0.5rem;
        }
        .stage-focus li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #3498db;
            font-weight: bold;
        }

        /* --- é ç±¤æ¨™é¡Œ (ä¾†è‡ªæ‚¨çš„ç¬¬ä¸€å€‹ç¯„æœ¬) --- */
        .stage-title { 
            font-size: 1.875rem; 
            font-weight: 700; 
            color: #2980b9;
            border-bottom: 3px solid #a9d6f5;
            padding-bottom: 0.75rem; 
            margin-bottom: 1.75rem;
            background: linear-gradient(to right, #3498db, #2980b9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* --- å·¥å…·å€å¡Š (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        .tool-block { 
            margin-bottom: 2.5rem; 
            border-left: 4px solid #3498db;
            padding-left: 1.25rem;
            background: linear-gradient(to right, rgba(52, 152, 219, 0.03), transparent);
            border-radius: 0 0.5rem 0.5rem 0;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        
        .tool-label { /* ç¾åœ¨ç”¨æ–¼ OGSM å…§éƒ¨çš„å¤§æ¨™é¡Œ */
            font-size: 1.1rem; 
            font-weight: 600; 
            color: #1e3a8a; /* æ·±è—è‰² */
            margin-bottom: 0.5rem; 
            display: block;
        }
        
        .tool-description { 
            font-size: 0.9rem; 
            color: #64748b; 
            margin-bottom: 1rem; 
            font-style: italic;
        }
        
        .sub-label { 
            font-size: 0.95rem; 
            font-weight: 500; 
            color: #475569; 
            margin-bottom: 0.375rem; 
            display: block; 
        }

        /* --- å¤šè¼¸å…¥æ¡†ä½ˆå±€ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        .toolkit {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            gap: 20px;
            margin-top: 0.75rem;
        }
        .toolkit > .input-group {
            width: 300px;
            max-width: 100%;
            margin-bottom: 0;
        }
        .input-group { 
            margin-bottom: 1.25rem; 
        }
        .input-group:last-child { 
            margin-bottom: 0; 
        }

        /* --- æŒ‰éˆ•æ¨£å¼ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        .btn-base {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-align: center;
        }
        .btn-base:hover { transform: translateY(-2px); }
        .btn-base:active { transform: translateY(-1px); }
        .btn-blue { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
        .btn-blue:hover { box-shadow: 0 8px 16px rgba(52, 152, 219, 0.3); }
        .export-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        .export-btn:hover:before { left: 100%; }
        
        /* --- éŸ¿æ‡‰å¼èª¿æ•´ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        @media print { 
            .no-print { display: none; } 
            /* åŒ¯å‡ºæ™‚å¼·åˆ¶é¡¯ç¤ºæ‰€æœ‰ Tab å…§å®¹ (é›–ç„¶ JS åŒ¯å‡ºä¸éœ€è¦) */
            .tab-content { display: block !important; animation: none; }
            .tab-buttons { display: none; }
        }
        
        @media (max-width: 768px) {
            .stage-title { font-size: 1.5rem; }
            .tab-btn { font-size: 0.875rem; padding: 0.75rem 1rem; }
        }
        
        /* --- è¼‰å…¥èˆ‡é€šçŸ¥ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) --- */
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.6s linear infinite;
            margin-left: 0.5rem;
        }
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
            max-width: 90vw;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .notification.success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 text-slate-800 min-h-screen">

    <div class="container mx-auto max-w-screen-xl p-4 sm:p-6 lg:p-10 bg-white rounded-2xl shadow-2xl my-6 sm:my-12">

        <div class="mb-8 border-b-2 border-slate-200 no-print">
            <nav class="tab-buttons" aria-label="Tabs">
                <button id="tab-btn-home" class="tab-btn active">ğŸ“š ç¸½è¦½</button>
                <button id="tab-btn-eisenhower" class="tab-btn inactive">1. è‰¾æ£®è±ªçŸ©é™£</button>
                <button id="tab-btn-scrum" class="tab-btn inactive">2. SCRUM</button>
                <button id="tab-btn-5w1h" class="tab-btn inactive">3. 5W1H</button>
                <button id="tab-btn-prep" class="tab-btn inactive">4. PREP</button>
                <button id="tab-btn-golden" class="tab-btn inactive">5. é»ƒé‡‘åœˆ</button>
                <button id="tab-btn-4p" class="tab-btn inactive">6. 4P</button>
                <button id="tab-btn-star" class="tab-btn inactive">7. STAR æ³•å‰‡</button>
                <button id="tab-btn-ogsm" class="tab-btn inactive">8. OGSM</button>
            </nav>
        </div>

        <div id="tab-content-home" class="tab-content active">
            <h2 class="stage-title">é«˜æ•ˆèƒ½å·¥å…·å·¥ä½œè¡¨ç¸½è¦½</h2>
            
            <div class="stage-focus">
                <h3>æ­¡è¿ä½¿ç”¨é«˜æ•ˆèƒ½å·¥å…·å·¥ä½œè¡¨</h3>
                <p>æœ¬å·¥å…·æ•´åˆäº† 8 å€‹åœ¨ä¸åŒæƒ…å¢ƒä¸‹æ¥µå…·åƒ¹å€¼çš„å·¥ä½œæ¡†æ¶ã€‚æ‚¨å¯ä»¥é€éä¸Šæ–¹é ç±¤åˆ‡æ›ä¸åŒçš„å·¥å…·ï¼Œä¾†å”åŠ©æ‚¨é‡æ¸…æ€ç·’ã€è¦åŠƒå°ˆæ¡ˆã€æ”¹å–„æºé€šï¼Œä¸¦åˆ¶å®šæ¸…æ™°çš„ç­–ç•¥ã€‚</p>
                <ul>
                    <li>è«‹å…ˆåœ¨ä¸‹æ–¹è¼¸å…¥æ‚¨æœ¬æ¬¡è¦åˆ†æçš„ä¸»é¡Œã€‚</li>
                    <li>åˆ‡æ›åˆ°æ‚¨éœ€è¦çš„å·¥å…·é ç±¤ï¼Œä¸¦å¡«å¯«å°æ‡‰çš„æ¬„ä½ã€‚</li>
                    <li>æ‚¨å¯ä»¥éš¨æ™‚ä½¿ç”¨ã€Œå„²å­˜è‡³ç€è¦½å™¨ã€ä¾†æš«å­˜é€²åº¦ã€‚</li>
                    <li>å®Œæˆå¾Œï¼Œå¯é»é¸ã€ŒåŒ¯å‡ºç‚º Word æ–‡ä»¶ã€ä¾†ç”¢ç”Ÿä¸€ä»½åŒ…å«æ‰€æœ‰å·²å¡«å¯«å…§å®¹çš„å®Œæ•´å ±å‘Šã€‚</li>
                </ul>
            </div>

            <div class="mb-8">
                <label for="ws-topic" class="text-xl font-semibold text-gray-800 block mb-2"> ğŸ“‹ åˆ†æä¸»é¡Œ / å°ˆæ¡ˆåç¨±
                </label>
                <input type="text" id="ws-topic" class="worksheet-input" placeholder="è«‹è¼¸å…¥æ‚¨è¦æ‡‰ç”¨çš„ä¸»é¡Œæˆ–å°ˆæ¡ˆåç¨±..." style="min-height: 50px;">
            </div>
        </div>
        
        <div id="tab-content-eisenhower" class="tab-content">
            <h2 class="stage-title">1. è‰¾æ£®è±ªçŸ©é™£ (Eisenhower Matrix)</h2>
            <div class="tool-block">
                <p class="tool-description">æ­¤å·¥å…·ç”¨æ–¼ä»»å‹™æ’åºï¼Œå¹«åŠ©æ‚¨å°ˆæ³¨æ–¼æœ€é‡è¦çš„äº‹å‹™ã€‚è«‹å°‡æ‰€æœ‰å¾…è¾¦äº‹é …å¡«å…¥ä»¥ä¸‹å››å€‹è±¡é™ï¼š</p>
                <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-1-q1" class="sub-label">é‡è¦ä¸”ç·Šæ€¥ (Do First)</label>
                        <textarea id="tool-1-q1" class="worksheet-input" placeholder="ç«‹å³åŸ·è¡Œçš„ä»»å‹™..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-1-q2" class="sub-label">é‡è¦ä¸ç·Šæ€¥ (Schedule)</label>
                        <textarea id="tool-1-q2" class="worksheet-input" placeholder="å®‰æ’æ™‚é–“åŸ·è¡Œçš„ä»»å‹™..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-1-q3" class="sub-label">ä¸é‡è¦ä½†ç·Šæ€¥ (Delegate)</label>
                        <textarea id="tool-1-q3" class="worksheet-input" placeholder="å¯ä»¥äº¤è¾¦çš„ä»»å‹™..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-1-q4" class="sub-label">ä¸é‡è¦ä¸ç·Šæ€¥ (Delete)</label>
                        <textarea id="tool-1-q4" class="worksheet-input" placeholder="å¯ä»¥æ’é™¤çš„ä»»å‹™..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-scrum" class="tab-content">
             <h2 class="stage-title">2. SCRUM (æ•æ·é–‹ç™¼)</h2>
            <div class="tool-block">
                <p class="tool-description">ç”¨æ–¼è¤‡é›œå°ˆæ¡ˆç®¡ç†ï¼Œå¼·èª¿è¿­ä»£èˆ‡éˆæ´»ã€‚è«‹å®šç¾©æ‚¨å°ˆæ¡ˆçš„æ ¸å¿ƒçµ„ä»¶ï¼š</p>
                <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-2-backlog" class="sub-label">ç”¢å“å¾…è¾¦æ¸…å–® (Product Backlog)</label>
                        <textarea id="tool-2-backlog" class="worksheet-input" placeholder="å°ˆæ¡ˆçš„ç¸½éœ€æ±‚èˆ‡åŠŸèƒ½..."></textarea>
                    </div>
                     <div class="input-group">
                        <label for="tool-2-sprint" class="sub-label">è¡åˆºå¾…è¾¦æ¸…å–® (Sprint Backlog)</label>
                        <textarea id="tool-2-sprint" class="worksheet-input" placeholder="æœ¬æ¬¡è¿­ä»£è¦å®Œæˆçš„å…·é«”ä»»å‹™..."></textarea>
                    </div>
                     <div class="input-group">
                        <label for="tool-2-dod" class="sub-label">å®Œæˆçš„å®šç¾© (Definition of Done)</label>
                        <textarea id="tool-2-dod" class="worksheet-input" placeholder="ç¬¦åˆä»€éº¼æ¨™æº–æ‰ç®—ã€Œå®Œæˆã€ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-2-retro" class="sub-label">å›é¡§æœƒè­°ç­†è¨˜ (Retrospective)</label>
                        <textarea id="tool-2-retro" class="worksheet-input" placeholder="å“ªäº›åšå¾—å¥½ï¼Ÿå“ªäº›è¦æ”¹é€²ï¼Ÿ"></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="tab-content-5w1h" class="tab-content">
            <h2 class="stage-title">3. 5W1H</h2>
            <div class="tool-block">
                <p class="tool-description">ç”¨æ–¼é‡æ¸…å•é¡Œæˆ–è¦åŠƒä»»å‹™ã€‚é€éå›ç­”é€™å…­å€‹å•é¡Œï¼Œç¢ºä¿æ‚¨å·²å‘¨å…¨åœ°è€ƒæ…®ä¸€å€‹è¨ˆç•«ï¼š</p>
                <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-3-what" class="sub-label">What (ä»€éº¼äº‹)</label>
                        <textarea id="tool-3-what" class="worksheet-input" placeholder="ä»»å‹™çš„å…§å®¹æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-3-why" class="sub-label">Why (ç‚ºä»€éº¼)</label>
                        <textarea id="tool-3-why" class="worksheet-input" placeholder="åŸ·è¡Œçš„ç›®çš„èˆ‡ç†ç”±ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-3-who" class="sub-label">Who (èª°)</label>
                        <textarea id="tool-3-who" class="worksheet-input" placeholder="ç”±èª°åŸ·è¡Œï¼Ÿå—çœ¾æ˜¯èª°ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-3-when" class="sub-label">When (ä½•æ™‚)</label>
                        <textarea id="tool-3-when" class="worksheet-input" placeholder="åŸ·è¡Œçš„æ™‚é–“èˆ‡æ™‚ç¨‹ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-3-where" class="sub-label">Where (ä½•åœ°)</label>
                        <textarea id="tool-3-where" class="worksheet-input" placeholder="åœ¨å“ªè£¡åŸ·è¡Œï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-3-how" class="sub-label">How (å¦‚ä½•åš)</label>
                        <textarea id="tool-3-how" class="worksheet-input" placeholder="åŸ·è¡Œçš„æ–¹æ³•èˆ‡æ­¥é©Ÿï¼Ÿ"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-prep" class="tab-content">
            <h2 class="stage-title">4. PREP (æºé€šè¡¨é”)</h2>
            <div class="tool-block">
                <p class="tool-description">ç”¨æ–¼çµæ§‹åŒ–è¡¨é”ï¼Œç¢ºä¿æ¸…æ¥šå‚³é”è«–é»ã€‚é©åˆç”¨æ–¼ç°¡å ±ã€æœƒè­°ç™¼è¨€æˆ–æ’°å¯«å ±å‘Šï¼š</p>
                <div class="toolkit">
                     <div class="input-group">
                        <label for="tool-4-p1" class="sub-label">Point (è«–é»)</label>
                        <textarea id="tool-4-p1" class="worksheet-input" placeholder="é¦–å…ˆï¼Œæ¸…æ¥šèªªå‡ºæ‚¨çš„æ ¸å¿ƒè«–é»..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-4-r" class="sub-label">Reason (ç†ç”±)</label>
                        <textarea id="tool-4-r" class="worksheet-input" placeholder="æ¥è‘—ï¼Œèªªæ˜æ”¯æŒè«–é»çš„ç†ç”±..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-4-e" class="sub-label">Example (ç¯„ä¾‹)</label>
                        <textarea id="tool-4-e" class="worksheet-input" placeholder="ç„¶å¾Œï¼Œæä¾›å…·é«”çš„ç¯„ä¾‹æˆ–æ•¸æ“š..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-4-p2" class="sub-label">Point (é‡ç”³è«–é»)</label>
                        <textarea id="tool-4-p2" class="worksheet-input" placeholder="æœ€å¾Œï¼Œå†æ¬¡å¼·èª¿æ‚¨çš„æ ¸å¿ƒè«–é»..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-golden" class="tab-content">
            <h2 class="stage-title">5. é»ƒé‡‘åœˆ (Golden Circle)</h2>
            <div class="tool-block">
                <p class="tool-description">ç”±å…§è€Œå¤–æ€è€ƒï¼Œæ‰¾åˆ°æ ¸å¿ƒåƒ¹å€¼èˆ‡å‹•æ©Ÿã€‚é‡æ¸…æ‚¨çš„ã€Œç‚ºä»€éº¼ã€ï¼Œèƒ½è®“æºé€šæ›´æ‰“å‹•äººå¿ƒï¼š</p>
                <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-5-why" class="sub-label">Why (ç‚ºä»€éº¼)</label>
                        <textarea id="tool-5-why" class="worksheet-input" placeholder="æˆ‘å€‘çš„æ ¸å¿ƒä¿¡å¿µã€å‹•æ©Ÿã€ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-5-how" class="sub-label">How (å¦‚ä½•åš)</label>
                        <textarea id="tool-5-how" class="worksheet-input" placeholder="æˆ‘å€‘ç”¨ä»€éº¼ç¨ç‰¹çš„æ–¹æ³•æˆ–åƒ¹å€¼è§€ä¾†å¯¦è¸ Whyï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-5-what" class="sub-label">What (åšä»€éº¼)</label>
                        <textarea id="tool-5-what" class="worksheet-input" placeholder="æˆ‘å€‘å…·é«”æä¾›ä»€éº¼ç”¢å“æˆ–æœå‹™ï¼Ÿ"></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="tab-content-4p" class="tab-content">
            <h2 class="stage-title">6. 4P (è¡ŒéŠ·çµ„åˆ)</h2>
            <div class="tool-block">
                <p class="tool-description">è¦åŠƒè¡ŒéŠ·ç­–ç•¥çš„åŸºæœ¬æ¡†æ¶ã€‚è«‹åˆ†ææ‚¨ç”¢å“çš„è¡ŒéŠ·çµ„åˆï¼š</p>
                 <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-6-product" class="sub-label">Product (ç”¢å“)</label>
                        <textarea id="tool-6-product" class="worksheet-input" placeholder="ç”¢å“çš„æ ¸å¿ƒåŠŸèƒ½ã€ç‰¹è‰²ã€åŒ…è£..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-6-price" class="sub-label">Price (åƒ¹æ ¼)</label>
                        <textarea id="tool-6-price" class="worksheet-input" placeholder="å®šåƒ¹ç­–ç•¥ã€æŠ˜æ‰£ã€ä»˜æ¬¾æ–¹å¼..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-6-place" class="sub-label">Place (é€šè·¯)</label>
                        <textarea id="tool-6-place" class="worksheet-input" placeholder="éŠ·å”®ç®¡é“ã€ç¶“éŠ·å•†ã€ç‰©æµ..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-6-promotion" class="sub-label">Promotion (ä¿ƒéŠ·)</label>
                        <textarea id="tool-6-promotion" class="worksheet-input" placeholder="å»£å‘Šã€å…¬é—œã€ä¿ƒéŠ·æ´»å‹•ã€ç¤¾ç¾¤è¡ŒéŠ·..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-star" class="tab-content">
            <h2 class="stage-title">7. STAR æ³•å‰‡ (STAR Method)</h2>
            <div class="tool-block">
                <p class="tool-description">ç”¨æ–¼çµæ§‹åŒ–é™³è¿°ç¶“é©—ï¼Œå¸¸è¦‹æ–¼é¢è©¦æˆ–ç¸¾æ•ˆè©•ä¼°ã€‚è«‹æè¿°ä¸€å€‹å…·é«”çš„ç¶“é©—ï¼š</p>
                 <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-7-s" class="sub-label">S (Situation) - æƒ…å¢ƒ</label>
                        <textarea id="tool-7-s" class="worksheet-input" placeholder="ç•¶æ™‚çš„ç‹€æ³ã€èƒŒæ™¯æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-7-t" class="sub-label">T (Task) - ä»»å‹™</label>
                        <textarea id="tool-7-t" class="worksheet-input" placeholder="ä½ ç•¶æ™‚çš„ä»»å‹™æˆ–è¦é”æˆçš„ç›®æ¨™æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-7-a" class="sub-label">A (Action) - è¡Œå‹•</label>
                        <textarea id="tool-7-a" class="worksheet-input" placeholder="ä½ æ¡å–äº†å“ªäº›å…·é«”è¡Œå‹•ï¼Ÿ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-7-r" class="sub-label">R (Result) - çµæœ</label>
                        <textarea id="tool-7-r" class="worksheet-input" placeholder="æœ€å¾Œçš„æˆæœæ˜¯ä»€éº¼ï¼Ÿæœ‰ä½•é‡åŒ–æ•¸æ“šï¼Ÿ"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-ogsm" class="tab-content">
            <h2 class="stage-title">8. OGSM (ç›®æ¨™ã€ç›®çš„ã€ç­–ç•¥ã€è¡¡é‡)</h2>
            <div class="tool-block">
                <p class="tool-description">ç”¨æ–¼çµ„ç¹”æˆ–å°ˆæ¡ˆçš„ç­–ç•¥è¦åŠƒèˆ‡åŸ·è¡Œè¿½è¹¤ã€‚é€™æ˜¯ä¸€å€‹å°‡é å¤§ç›®æ¨™æ‹†è§£ç‚ºå…·é«”è¡Œå‹•çš„å¼·å¤§å·¥å…·ã€‚</p>
                <div class="input-group">
                    <label class="tool-label">O (Objective) - æœ€çµ‚ç›®çš„</label>
                    <textarea id="tool-8-o" class="worksheet-input" placeholder="æ•´å€‹å°ˆæ¡ˆæˆ–çµ„ç¹”è¦é”æˆçš„é å¤§ç›®æ¨™æ˜¯ä»€éº¼ï¼Ÿï¼ˆä¾‹å¦‚ï¼šæˆç‚ºå¸‚å ´é ˜å°è€…ï¼‰"></textarea>
                </div>
                <div class="input-group">
                    <label class="tool-label">G (Goal) - å…·é«”ç›®æ¨™</label>
                    <textarea id="tool-8-g" class="worksheet-input" placeholder="ç‚ºäº†é”æˆ Objectiveï¼Œå…·é«”å¯é‡åŒ–çš„ç›®æ¨™æœ‰å“ªäº›ï¼Ÿï¼ˆä¾‹å¦‚ï¼šå¸‚å ´ä½”æœ‰ç‡æå‡è‡³30%ï¼‰"></textarea>
                </div>
                <div class="input-group">
                    <label class="tool-label">S (Strategy) - ç­–ç•¥</label>
                    <textarea id="tool-8-s" class="worksheet-input" placeholder="æˆ‘å€‘è¦å¦‚ä½•é”æˆé€™äº› Goalï¼Ÿæ¡å–çš„è¡Œå‹•æ–¹é‡æ˜¯ä»€éº¼ï¼Ÿï¼ˆä¾‹å¦‚ï¼šé–‹ç™¼æ–°ç”¢å“ç·šã€æ‹“å±•ç·šä¸Šé€šè·¯ï¼‰"></textarea>
                </div>
                
                <label class="tool-label mt-6">M (Measure) - è¡¡é‡</label>
                <div class="toolkit">
                    <div class="input-group">
                        <label for="tool-8-m-dashboard" class="sub-label">è¡¡é‡æŒ‡æ¨™ (Dashboard)</label>
                        <textarea id="tool-8-m-dashboard" class="worksheet-input" placeholder="å¦‚ä½•è¡¡é‡ç­–ç•¥åŸ·è¡Œçš„é€²åº¦èˆ‡æˆæ•ˆï¼Ÿï¼ˆä¾‹å¦‚ï¼šæ¯æœˆæ–°å®¢æˆ¶æ•¸ã€è½‰æ›ç‡ï¼‰"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="tool-8-m-action" class="sub-label">è¡Œå‹•è¨ˆç•« (Action Plan)</label>
                        <textarea id="tool-8-m-action" class="worksheet-input" placeholder="ç‚ºäº†é”æˆæŒ‡æ¨™ï¼Œéœ€è¦åŸ·è¡Œçš„å…·é«”è¡Œå‹•èˆ‡æ™‚é–“é»ï¼Ÿï¼ˆä¾‹å¦‚ï¼šQ1 å®Œæˆç”¢å“åŸå‹ã€Q2 ä¸Šç·šæ–°å®˜ç¶²ï¼‰"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-12 space-y-4 no-print">
            <div class="flex flex-wrap justify-center gap-4">
                <button id="saveButton" class="btn-base btn-blue focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    ğŸ’¾ å„²å­˜è‡³ç€è¦½å™¨
                </button>
                <button id="loadButton" class="btn-base btn-blue focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    ğŸ“‚ è¼‰å…¥å·²å„²å­˜è³‡æ–™
                </button>
                <button id="exportButton" class="btn-base btn-blue export-btn focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    ğŸš€ åŒ¯å‡ºç‚º Word æ–‡ä»¶
                </button>
            </div>
            <p class="text-sm text-slate-500 mt-2">
                ğŸ’¡ æç¤ºï¼šå®šæœŸå„²å­˜æ‚¨çš„å·¥ä½œï¼Œé¿å…è³‡æ–™éºå¤±
            </p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        // --- Tab è™•ç† (ä¾†è‡ªæ‚¨çš„ç¬¬ä¸€å€‹ç¯„æœ¬) ---
        const tabs = {
            home: { btn: document.getElementById('tab-btn-home'), content: document.getElementById('tab-content-home') },
            eisenhower: { btn: document.getElementById('tab-btn-eisenhower'), content: document.getElementById('tab-content-eisenhower') },
            scrum: { btn: document.getElementById('tab-btn-scrum'), content: document.getElementById('tab-content-scrum') },
            '5w1h': { btn: document.getElementById('tab-btn-5w1h'), content: document.getElementById('tab-content-5w1h') },
            prep: { btn: document.getElementById('tab-btn-prep'), content: document.getElementById('tab-content-prep') },
            golden: { btn: document.getElementById('tab-btn-golden'), content: document.getElementById('tab-content-golden') },
            '4p': { btn: document.getElementById('tab-btn-4p'), content: document.getElementById('tab-content-4p') },
            star: { btn: document.getElementById('tab-btn-star'), content: document.getElementById('tab-content-star') },
            ogsm: { btn: document.getElementById('tab-btn-ogsm'), content: document.getElementById('tab-content-ogsm') }
        };

        function setActiveTab(activeTabName) {
            Object.keys(tabs).forEach(tabName => {
                const isActive = tabName === activeTabName;
                if (tabs[tabName].btn) {
                    tabs[tabName].btn.classList.toggle('active', isActive);
                    tabs[tabName].btn.classList.toggle('inactive', !isActive);
                }
                if (tabs[tabName].content) {
                    tabs[tabName].content.classList.toggle('active', isActive);
                }
            });
        }

        Object.keys(tabs).forEach(tabName => {
            if (tabs[tabName].btn) {
                tabs[tabName].btn.addEventListener('click', () => setActiveTab(tabName));
            }
        });
        // --- Tab è™•ç†çµæŸ ---

        // --- æŒ‰éˆ•èˆ‡åŠŸèƒ½ ---
        const exportButton = document.getElementById('exportButton');
        const saveButton = document.getElementById('saveButton');
        const loadButton = document.getElementById('loadButton');
        const wsTopic = document.getElementById('ws-topic');
        
        // --- é€šçŸ¥åŠŸèƒ½ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) ---
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // --- å„²å­˜åŠŸèƒ½ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) ---
        const storageKey = 'managerToday8ToolsTabsData'; // æ›´æ–°å­˜å„²éµ
        saveButton.addEventListener('click', () => {
            try {
                const data = {};
                document.querySelectorAll('input[type="text"], textarea').forEach(el => {
                    if (el.id) {
                        data[el.id] = el.value;
                    }
                });
                
                const timestamp = new Date().toLocaleString('zh-TW');
                data._savedAt = timestamp;
                
                localStorage.setItem(storageKey, JSON.stringify(data)); 
                showNotification(`âœ… è³‡æ–™å·²æˆåŠŸå„²å­˜ï¼ˆ${timestamp}ï¼‰`, 'success');
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—ï¼š', error);
                showNotification('âŒ å„²å­˜å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 'error');
            }
        });

        // --- è¼‰å…¥åŠŸèƒ½ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) ---
        loadButton.addEventListener('click', () => {
            try {
                const savedData = localStorage.getItem(storageKey); 
                if (!savedData) {
                    showNotification('â„¹ï¸ å°šç„¡å·²å„²å­˜çš„è³‡æ–™', 'error');
                    return;
                }
                
                const data = JSON.parse(savedData);
                let loadedCount = 0;
                
                Object.keys(data).forEach(id => {
                    if (id !== '_savedAt') {
                        const el = document.getElementById(id);
                        if (el) {
                            el.value = data[id];
                            loadedCount++;
                        }
                    }
                });
                
                const savedAt = data._savedAt || 'æœªçŸ¥æ™‚é–“';
                showNotification(`âœ… å·²è¼‰å…¥ ${loadedCount} å€‹æ¬„ä½ï¼ˆå„²å­˜æ–¼ ${savedAt}ï¼‰`, 'success');
            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—ï¼š', error);
                showNotification('âŒ è¼‰å…¥å¤±æ•—ï¼Œè³‡æ–™å¯èƒ½å·²æå£', 'error');
            }
        });

        // --- åŒ¯å‡ºåŠŸèƒ½ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬ï¼Œå·²æ›´æ–°æ¨™é¡Œ) ---
        exportButton.addEventListener('click', function() {
            const originalText = exportButton.innerHTML;
            exportButton.innerHTML = 'â³ è™•ç†ä¸­...<span class="loading"></span>';
            exportButton.disabled = true;
            
            setTimeout(() => {
                try {
                    const exportWrapper = document.createElement('div');
                    const mainTitleText = "é«˜æ•ˆèƒ½å·¥å…·å·¥ä½œè¡¨"; // åŒ¯å‡ºæ¨™é¡Œ

                    const titleH1 = document.createElement('h1');
                    titleH1.textContent = mainTitleText;
                    exportWrapper.appendChild(titleH1);

                    if (wsTopic && wsTopic.value.trim()) {
                        const topicH3 = document.createElement('h3');
                        topicH3.style.fontSize = '14pt'; 
                        topicH3.style.textAlign = 'center';
                        topicH3.style.marginBottom = '20px';
                        topicH3.textContent = "åˆ†æä¸»é¡Œï¼š" + wsTopic.value;
                        exportWrapper.appendChild(topicH3);
                    }
                    
                    let hasAnyContent = false;
                    
                    // éæ­·æ‰€æœ‰ .tool-blockï¼Œç„¡è«–åœ¨å“ªå€‹ tab ä¸‹
                    document.querySelectorAll('.tool-block').forEach((toolBlock, index) => {
                        let toolHasContent = false;
                        toolBlock.querySelectorAll('textarea.worksheet-input').forEach(textarea => {
                            if (textarea.value.trim() !== '') {
                                toolHasContent = true;
                                hasAnyContent = true;
                            }
                        });
                        
                        if (!toolHasContent) return; // å¦‚æœæ­¤å·¥å…·å€å¡Šæ²’å…§å®¹ï¼Œè·³é

                        if (exportWrapper.querySelector('h2')) { // åœ¨å·¥å…·ä¹‹é–“åŠ å…¥åˆ†é ç¬¦
                            const pageBreak = document.createElement('p');
                            pageBreak.setAttribute('style', 'page-break-before: always;');
                            exportWrapper.appendChild(pageBreak);
                        } else {
                            const hr = document.createElement('hr'); // ç¬¬ä¸€å€‹å·¥å…·å‰åŠ åˆ†éš”ç·š
                            exportWrapper.appendChild(hr);
                        }
                        
                        // æŠ“å– Tab çš„ H2 æ¨™é¡Œ
                        const toolTitleH2 = toolBlock.closest('.tab-content').querySelector('.stage-title');
                        if (toolTitleH2) {
                            const toolH2 = document.createElement('h2');
                            toolH2.textContent = toolTitleH2.textContent.trim();
                            exportWrapper.appendChild(toolH2);
                        }
                        
                        const toolDescription = toolBlock.querySelector('.tool-description');
                        if (toolDescription) {
                            const descP = document.createElement('p');
                            descP.style.fontStyle = 'italic';
                            descP.style.fontSize = '10pt';
                            descP.style.color = '#6b7280';
                            descP.textContent = toolDescription.textContent.trim();
                            exportWrapper.appendChild(descP);
                        }

                        // æŠ“å– .input-group
                        toolBlock.querySelectorAll('.input-group').forEach(group => {
                            const subLabel = group.querySelector('.sub-label, .tool-label'); // ä¹ŸæŠ“ OGSM çš„ tool-label
                            const textarea = group.querySelector('textarea.worksheet-input');

                            if (subLabel && textarea && textarea.value.trim()) {
                                const subH4 = document.createElement('h4');
                                subH4.textContent = subLabel.textContent.trim();
                                exportWrapper.appendChild(subH4);
                                const p = createParagraphFromInput(textarea);
                                exportWrapper.appendChild(p);
                            }
                        });
                    });
                    
                    if (!hasAnyContent && !wsTopic.value.trim()) {
                        showNotification('â„¹ï¸ æ²’æœ‰è¦åŒ¯å‡ºçš„å…§å®¹ï¼Œè«‹å…ˆå¡«å¯«å·¥ä½œè¡¨', 'error');
                        exportButton.innerHTML = originalText;
                        exportButton.disabled = false;
                        return;
                    }
                    
                    // (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬)
                    function createParagraphFromInput(inputElement) {
                        const p = document.createElement('p');
                        if (inputElement.value && inputElement.value.trim() !== '') {
                            p.setAttribute('style', 'border: 1px solid #d1d5db; padding: 8px 10px; margin: 3px 0 12px 0; background-color: #f9fafb; white-space: pre-wrap; font-size: 10pt; color: #1f2937;');
                            p.textContent = inputElement.value;
                        }
                        return p;
                    }

                    // (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬)
                    const finalHtmlString = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <style>
                                body { font-family: 'Arial', 'Microsoft JhengHei', sans-serif; font-size: 11pt; line-height: 1.6; color: #374151; }
                                h1 { font-size: 20pt; text-align: center; font-weight: bold; color: #111827; margin-bottom: 15px;}
                                h2 { font-size: 16pt; font-weight: bold; color: #2980b9; margin-top: 30px; margin-bottom: 15px; border-bottom: 2px solid #a9d6f5; padding-bottom: 8px; }
                                h3 { font-size: 14pt; font-weight: bold; color: #1f2937; margin-top: 20px; margin-bottom: 10px; text-align: center; }
                                h4 { font-size: 11pt; font-weight: bold; color: #475569; margin-top: 12px; margin-bottom: 5px; }
                                p { margin-bottom: 15px; white-space: pre-wrap; }
                                hr { border: none; border-top: 1px dashed #9ca3af; margin: 30px 0; }
                            </style>
                        </head>
                        <body>
                            ${exportWrapper.innerHTML}
                        </body>
                        </html>
                    `;

                    // (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬)
                    const converted = htmlDocx.asBlob(finalHtmlString, {
                        orientation: 'portrait',
                        margins: { top: 720, bottom: 720, left: 720, right: 720 }
                    });

                    const filename = `${wsTopic.value || '8å€‹é«˜æ•ˆèƒ½å·¥å…·å·¥ä½œè¡¨'}_${new Date().toISOString().slice(0,10)}.docx`;
                    saveAs(converted, filename);
                    
                    showNotification('âœ… Word æ–‡ä»¶å·²æˆåŠŸåŒ¯å‡ºï¼', 'success');

                } catch (error) {
                    console.error("åŒ¯å‡ºå¤±æ•—ï¼š", error);
                    showNotification('âŒ åŒ¯å‡ºå¤±æ•—ï¼Œè«‹æª¢æŸ¥æ§åˆ¶å°', 'error');
                } finally {
                    exportButton.innerHTML = originalText;
                    exportButton.disabled = false;
                }
            }, 100);
        });
        
        // --- è‡ªå‹•å„²å­˜æé†’ (ä¾†è‡ªæ‚¨çš„ç¯„æœ¬) ---
        let autoSaveInterval;
        const startAutoSaveReminder = () => {
            clearInterval(autoSaveInterval);
            autoSaveInterval = setInterval(() => {
                const hasContent = Array.from(document.querySelectorAll('textarea.worksheet-input'))
                    .some(el => el.value.trim() !== '');
                if (hasContent) {
                    showNotification('ğŸ’¡ åˆ¥å¿˜äº†å„²å­˜æ‚¨çš„å·¥ä½œé€²åº¦ï¼', 'success');
                }
            }, 600000); // 10 åˆ†é˜æé†’ä¸€æ¬¡
        };
        
        startAutoSaveReminder();
        
        // è¨­ç½®é è¨­ Tab
        setActiveTab('home');
    });
    </script>

</body>
</html>
